# ============================================================================
# API Key 定義與驗證
# ============================================================================
# 此檔案定義所有有效的 API Keys 及其對應的客戶名稱
#
# 格式：
#   "API_KEY_字串"    "客戶名稱";
#
# 安全建議：
# - 使用強隨機字串（至少 32 字元）
# - 定期輪換 Keys
# - 不同環境使用不同 Keys
# - 不要提交真實 Keys 到版本控制
# ============================================================================

# Map HTTP Header 'X-API-Key' 的值到客戶名稱
# 如果找不到對應的 Key，$api_client_name 會是空字串
map $http_x_api_key $api_client_name {
    default "";  # 未知的 API Key

    # ========================================================================
    # 開發環境 Keys
    # ========================================================================
    "dev-key-12345678901234567890"        "development";
    "test-key-abcdefghijklmnopqrs"        "testing";

    # ========================================================================
    # 生產環境 Keys（範例，請替換成真實的強隨機字串）
    # ========================================================================
    # 生成強隨機 Key 指令：
    # openssl rand -base64 32
    # 或
    # cat /dev/urandom | tr -dc 'a-zA-Z0-9' | fold -w 48 | head -n 1

    # "ABCxyz123456789_REPLACE_ME_001"    "partner-company-a";
    # "DEFabc987654321_REPLACE_ME_002"    "partner-company-b";
    # "GHIjkl555444333_REPLACE_ME_003"    "internal-service-x";

    # ========================================================================
    # 不同權限級別的 Keys（可選，進階用法）
    # ========================================================================
    # "readonly-key-111"                  "readonly-client";
    # "admin-key-999"                     "admin-client";
}

# ============================================================================
# API Key 權限控管（可選，進階用法）
# ============================================================================
# 定義不同客戶的存取權限
# map $api_client_name $api_permissions {
#     default                 "none";
#     "development"           "all";
#     "partner-company-a"     "read-only";
#     "partner-company-b"     "read-write";
#     "internal-service-x"    "all";
# }

# ============================================================================
# IP 白名單（可選）
# ============================================================================
# 限制特定 API Key 只能從特定 IP 訪問
# geo $remote_addr $allowed_ip {
#     default         0;
#     127.0.0.1       1;  # localhost
#     10.0.0.0/8      1;  # 內部網路
#     192.168.1.100   1;  # 特定 IP
# }
